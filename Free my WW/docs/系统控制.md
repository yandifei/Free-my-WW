# <center>系统控制（windows）</center>
# 库的创建原因
在写脚本的时候会不可避免的和win系统有交流，这个库就是为了方便对win系统做出各种操作而去写的的，有通过窗口句柄控制窗口的函数（如去标题栏、隐藏等等）
# 库功能简述
1. 限制和解除鼠标光标范围限制
***
# 1. 限制和解除鼠标光标范围限制
```python
# 导包
import win32api
import win32con
# 自己的包
from UserFeedback import *  # 用户反馈
from SysInformation import *    # 获取系统信息

def limit_cursor(left, top, right, bottom):
    """鼠标光标范围限制（即使程序结束了，效果还在，但是切屏效果就没了）
    填入参数：左、上、右、下    (left, top, right, bottom)
    """
    status_feedback("开始对鼠标光标范围进行限制")
    limit = (left, top, right, bottom)  # 转换为元组类型
    progress_feedback(f"解除限制范围:{limit}")
    win32api.ClipCursor(limit)
    status_feedback("完成对鼠标光标范围进行限制")

def release_cursor():
    """解除鼠标光标的范围的限制（当前屏幕的逻辑分辨率）"""
    status_feedback("开始解除鼠标光标的范围的限制")
    current_mxa_screen_resolution = get_screen_resolution() # 获得屏幕缩放后最大的分辨率（包括任务栏）
    release = (0, 0, current_mxa_screen_resolution[0], current_mxa_screen_resolution[1])    # 转为元组类型
    progress_feedback(f"解除限制范围:{0, 0, current_mxa_screen_resolution[0], current_mxa_screen_resolution[1]}")
    # 因为参数不能为None，否者报错，所以我改为了最适合当前屏幕分辨率的范围
    win32api.ClipCursor(release)
    status_feedback("完成解除鼠标光标的范围的限制")
```
1. 权限问题：
确保程序以管理员权限运行（否则可能无法调用 ClipCursor）。
2. 多显示器支持：
ClipCursor 的坐标是相对于主显示器的左上角的。如果有多台示器，需要根据实际需求调整坐标。
3. 切屏问题：
如果用户切换到其他屏幕（如按 Win+Tab），限制可能会失效。这是 Windows 系统的默认行为。
4. 参数问题
win32api.ClipCursor(参数)，这个参数里面必须是元组，即使数值超出当前屏幕都没问题，其实解除鼠标光标的范围的限制比当前屏幕x和y多一个像素点的（1920X1080额不是1919X1079）
***
# 窗口控制
***(默认输入的句有效，如果无效则报错)需要结合SysInformation.py的模块获取句柄***
1. hide_window(hwnd)**任务管理器里面才能找到**
通过窗口句柄隐藏窗口
    参数：
    hwnd ： 需要隐藏的窗口的句柄
2. max_win(hwnd)
最大化窗口
    参数：
    hwnd ： 窗口句柄
3. min_win(hwnd)
   最小化窗口
    参数：
    hwnd ： 窗口句柄
4. close_win(hwnd)
   关闭窗口（如果输入的不是父窗口则关闭的是子窗口）
    参数：
    hwnd ： 需要关闭的窗口的句柄
5. show_window(hwnd)
   通过窗口句柄显示窗口
    参数：
    hwnd ： 需要显示的窗口的句柄
6. top_win(hwnd)
   将窗口置顶
    hwnd ： 窗口的句柄
7. cancel_top_win(hwnd)
   取消窗口置顶
    hwnd ： 窗口的句柄
8. move_win(hwnd, x, y, repaint=True)
   移动窗口到指定位置
    hwnd ： 窗口的句柄
    x ： 窗口左上角的x坐标
    y ： 窗口左上角的y坐标
    repaint : 重新绘制窗口，默认打开
9. set_win_size(hwnd, width, height, repaint=True)
    改变窗口的大小（坐标保持在左上角）
    hwnd ： 窗口的句柄
    width ： 设置窗口的宽度
    height ： 设置窗口的高度
    repaint : 重新绘制窗口，默认打开
10. set_win_geometry(hwnd, x, y, width, height,repaint=True)
    设置窗口的大小和位置(几何)
    参数(窗口大小是有默认限制的，超过则为窗口默认的最大或最小)：
    hwnd ： 窗口的句柄
    x ： 窗口左上角的x坐标
    y ： 窗口左上角的y坐标
    width ： 设置窗口的宽度
    height ： 设置窗口的高度
    repaint : 重新绘制窗口，默认打开
11. flash_win(hwnd,bitwise_inversion=True)
    使窗口闪烁或闪烁加颜色反转闪烁（这个函数通常用于当应用程序需要用户注意时，比如有新消息到达或者某个任务完成。）
    参数：
    hwnd ： 需要闪烁的窗口的句柄
    bitwise_inversion : 窗口颜色反转，默认True
12. focus_to_current_window(hwnd)
    把焦点设置在当前窗口或控件上（前台窗口或控件）用户主动触发的窗口切换（如弹窗）
    将指定窗口强制设为 前台活动窗口（即用户当前交互的窗口）。
    系统安全限制：Windows 10/11 会阻止非用户主动触发的窗口抢占前台（防止恶意弹窗）。
    参数：
    hwnd ： 窗口或控件的句柄
13. focus_to_window(hwnd)
    把焦点设置在窗口或控件上，始终置顶的监控窗口
    核心作用：将窗口调整到 Z 序的顶部（即窗口堆叠顺序的最前面），但不保证激活窗口或获得焦点。
    如果窗口处于最小化状态，会尝试恢复窗口到正常显示状态。
    参数：
    hwnd ： 窗口或控件的句柄
14. change_hwnd_title(hwnd, new_title)
改变窗口句柄标题
    参数：
    hwnd ： 需要改变标题的窗口句柄
    new_title ： 标题名称
    """
15. remove_max_mix_size(hwnd,mod=0)
    去除窗口的最大化和最小化以及大小缩放（如果标题栏是自己重写没有与win标题栏有关的就无法影响）
    hwnd ： 窗口的句柄
    mod : 1为仅去除最大化，2为仅去除最小化，3为仅去除窗口边缘拉伸，默认为0（都执行）
    返回值：
    如果窗口句柄无效就会报错
16. restore_max_mix_size(hwnd,mod=0)
    **& ~ 是去除， | 是使用**
恢复窗口的最大化和最小化以及大小缩放（如果标题栏是自己重没有与win标题栏有关的就无法影响）
hw nd ： 窗口的句柄
mod : 1为仅恢复最大化，2为仅恢复最小化，3为仅恢复窗边缘拉伸，默认为0（都执行）
返回值：
如果窗口句柄无效就会报错
17. remove_caption(hwnd)
    去掉标题栏(不包括窗口控制按钮)
    参数：
    hwnd ： 窗口的句柄
18. restore_caption(hwnd)
    恢复标题栏(不包括窗口控制按钮)
    参数：
    hwnd ： 窗口的句柄
19. remove_sysmenu(hwnd)
    去除系统菜单(去掉的窗口控制按钮)
    参数：
    hwnd ： 窗口的句柄
20. restore_sysmenu(hwnd)
    恢复系统菜单(恢复的窗口控制按钮)
    参数：
    hwnd ： 窗口的句柄
21. remove_title(hwnd)
    去除标题栏(去掉的窗口的标题栏)
    参数：
    hwnd ： 窗口的句柄
22. restore_title(hwnd)
    去除标题栏(去掉的窗口的标题栏)
    参数：
    hwnd ： 窗口的句柄
23. change_win_geometry(hwnd, mod=0)
    写的已经都够了，这个也可以，但是不知道设计出来有什么用
```python
def change_win_geometry(hwnd, mod=0):
    """很厉害但是好像没用"""
    """Z 顺序常量
    HWND_TOP	0	将窗口置于 Z 顺序顶部（但不强制置顶）。
    HWND_BOTTOM	1	将窗口置于 Z 顺序底部（可能被其他窗口覆盖）。
    HWND_TOPMOST	-1	强制窗口置顶（即使失去焦点也保持在最前）。
    HWND_NOTOPMOST	-2	取消窗口置顶状态，恢复到正常 Z 顺序。
    标志常量
    SWP_NOSIZE	0x0001	保持窗口当前尺寸，忽略 cx 和 cy 参数。
    SWP_NOMOVE	0x0002	保持窗口当前位置，忽略 x 和 y 参数。
    SWP_NOZORDER	0x0004	保持窗口当前 Z 顺序，忽略 hWndInsertAfter 参数。
    SWP_SHOWWINDOW	0x0040	显示窗口（如果窗口被隐藏）。"""
    win32_flags = None  # 用来存放顺序常量和标志常量（默认添加不移动位置）
    if mod == 0:
        win32_flags = win32con.SWP_NOSIZE | win32con.SWP_NOZORDER | win32con.SWP_NOMOVE # 不调整大小和层级
    elif mod == 1:
        win32_flags = win32con.SWP_NOSIZE | win32con.SWP_NOMOVE   # 不调大小
    elif mod == 2:
        win32_flags = win32con.SWP_NOZORDER | win32con.SWP_NOMOVE # 不调整层级
    win32gui.SetWindowPos(hwnd, win32con.HWND_TOP, 0, 0, 0, 0, win32_flags)
```